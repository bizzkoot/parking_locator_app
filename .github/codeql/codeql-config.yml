name: "CodeQL Config"

queries:
  - uses: security-and-quality

paths:
  - android
  - src
  - app/src/main/java
  - app/src/main/kotlin

paths-ignore:
  - node_modules
  - '**/*.test.ts'
  - '**/*.test.tsx'
  - '**/__tests__/**'
  - '**/build/**'
  - '**/generated/**'

build:
  debug: true
  command: |
    echo "${{ secrets.ANDROID_KEYSTORE_BASE64 }}" | base64 --decode > android/app/release.keystore
    chmod +x ./gradlew
    ./gradlew assembleRelease \
      -Pandroid.injected.signing.store.file=android/app/release.keystore \
      -Pandroid.injected.signing.store.password=${{ secrets.ANDROID_KEYSTORE_PASSWORD }} \
      -Pandroid.injected.signing.key.alias=${{ secrets.ANDROID_KEY_ALIAS }} \
      -Pandroid.injected.signing.key.password=${{ secrets.ANDROID_KEY_PASSWORD }} \
      --info --stacktrace    ./gradlew assembleDebug --info --stacktrace